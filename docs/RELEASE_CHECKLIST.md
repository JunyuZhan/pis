# 🚀 发布前检查清单

> 在发布新版本前，请完成以下检查清单

**最后更新**: 2026-02-01

---

## ✅ 代码质量检查

### 代码审查
- [ ] 所有代码已通过代码审查
- [ ] 没有未解决的 TODO/FIXME 注释
- [ ] 代码符合项目编码规范
- [ ] 所有导入的依赖都已正确声明

### 测试
- [ ] 所有单元测试通过：`pnpm test`
- [ ] 所有组件测试通过：`pnpm test:components`
- [ ] 所有 E2E 测试通过：`pnpm test:e2e`
- [ ] 测试覆盖率符合要求（>80%）
- [ ] 在主要浏览器中手动测试（Chrome, Firefox, Safari, Edge）

### 构建验证
- [ ] 生产构建成功：`pnpm build`
- [ ] 没有构建警告或错误
- [ ] Docker 镜像构建成功
- [ ] 所有服务可以正常启动

---

## 🔒 安全检查

### 安全扫描
- [ ] 运行安全检查：`pnpm security-check`
- [ ] 没有硬编码的密钥或密码
- [ ] 没有敏感信息泄露
- [ ] `.env` 文件已添加到 `.gitignore`
- [ ] `.env.example` 只包含占位符

### 依赖安全
- [ ] 运行依赖安全扫描：`pnpm audit` 或使用 Snyk/Dependabot
- [ ] 修复所有高危和中危漏洞
- [ ] 更新过时的依赖包

### 安全配置
- [ ] 速率限制已配置
- [ ] CORS 配置正确（不是 `*`）
- [ ] HTTPS 配置（生产环境）
- [ ] 安全响应头已配置
- [ ] EXIF 隐私保护已启用

---

## 📚 文档检查

### 核心文档
- [ ] README.md 已更新（英文和中文）
- [ ] docs/project/CHANGELOG.md 已更新，包含所有变更
- [ ] 部署文档已更新
- [ ] API 文档已更新（如有变更）

### 代码文档
- [ ] 所有公共 API 有 JSDoc 注释
- [ ] 复杂逻辑有注释说明
- [ ] 配置选项有说明文档

### 用户文档
- [ ] 用户指南已更新
- [ ] 故障排除指南已更新
- [ ] 迁移指南已更新（如有破坏性变更）

---

## 🐳 部署检查

### 部署脚本
- [ ] 一键部署脚本测试通过
- [ ] 升级脚本测试通过
- [ ] 回滚脚本可用（如有）
- [ ] 部署文档准确无误

### 环境配置
- [ ] `.env.example` 包含所有必需变量
- [ ] 环境变量文档已更新
- [ ] 默认配置安全合理
- [ ] 配置验证脚本工作正常

### Docker 配置
- [ ] Docker Compose 配置正确
- [ ] Dockerfile 优化合理
- [ ] 镜像大小合理
- [ ] 健康检查配置正确

---

## 🌐 兼容性检查

### 浏览器兼容性
- [ ] Chrome（最新版）
- [ ] Firefox（最新版）
- [ ] Safari（最新版）
- [ ] Edge（最新版）
- [ ] 移动浏览器（iOS Safari, Chrome Mobile）

### 平台兼容性
- [ ] Linux（Ubuntu/Debian）
- [ ] macOS
- [ ] Windows（如支持）
- [ ] Docker 环境

### 数据库兼容性
- [ ] PostgreSQL（主要支持）
- [ ] Supabase（向后兼容，如适用）

---

## 📦 发布准备

### 版本管理
- [ ] 版本号已更新（遵循语义化版本）
- [ ] docs/project/CHANGELOG.md 中的版本号正确
- [ ] package.json 中的版本号正确
- [ ] Git 标签准备就绪

### Git 状态
- [ ] 所有更改已提交
- [ ] 分支已推送到远程仓库
- [ ] 没有未提交的敏感文件
- [ ] Git 历史干净（没有敏感信息）

### GitHub 准备
- [ ] 创建 Release Notes
- [ ] 准备发布说明
- [ ] 添加发布标签
- [ ] 准备发布截图（如有 UI 变更）

---

## 🧪 预发布测试

### 功能测试
- [ ] 核心功能正常工作
- [ ] 新功能已测试
- [ ] 修复的 bug 已验证
- [ ] 回归测试通过

### 性能测试
- [ ] 页面加载时间合理
- [ ] API 响应时间正常
- [ ] 图片处理性能正常
- [ ] 数据库查询优化

### 压力测试
- [ ] 高并发场景测试
- [ ] 大文件上传测试
- [ ] 长时间运行稳定性测试

---

## 📝 发布后检查

### 发布验证
- [ ] GitHub Release 创建成功
- [ ] 发布说明正确
- [ ] 下载链接可用
- [ ] 文档链接正确

### 监控
- [ ] 错误监控已配置
- [ ] 性能监控已配置
- [ ] 日志收集正常
- [ ] 告警规则已设置

### 沟通
- [ ] 发布公告已准备
- [ ] 社区通知已发送（如适用）
- [ ] 文档已更新

---

## 🎯 快速检查命令

```bash
# 1. 代码质量
pnpm lint
pnpm test
pnpm build

# 2. 安全检查
pnpm security-check

# 3. 依赖检查
pnpm audit

# 4. 构建验证
pnpm build
cd docker && docker-compose build

# 5. Git 状态
git status
git log --oneline -10
```

---

## 📋 发布流程

1. **完成所有检查项** ✅
2. **更新版本号**：更新 `package.json` 和 `docs/project/CHANGELOG.md`
3. **提交更改**：`git commit -m "chore: bump version to x.x.x"`
4. **创建标签**：`git tag -a vx.x.x -m "Release x.x.x"`
5. **推送到远程**：`git push origin main --tags`
6. **创建 GitHub Release**：使用 GitHub Web UI 或 GitHub CLI
7. **验证发布**：检查 Release 页面和下载链接
8. **监控**：观察错误日志和性能指标

---

## ⚠️ 注意事项

- **不要跳过安全检查**：即使是很小的更新，也要运行安全检查
- **测试升级路径**：如果有数据库迁移，确保升级脚本测试通过
- **备份数据**：在生产环境部署前，确保有数据备份
- **分阶段发布**：考虑先发布到测试环境，再发布到生产环境
- **回滚计划**：准备回滚计划，以防发布后出现问题

---

## 🆘 遇到问题？

如果在发布过程中遇到问题：

1. **停止发布流程**
2. **记录问题**：详细记录错误信息和复现步骤
3. **修复问题**：修复后重新运行检查清单
4. **更新文档**：如果发现检查清单遗漏，更新此文档

---

**祝发布顺利！** 🎉
