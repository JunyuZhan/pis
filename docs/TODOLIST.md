# PIS 开发计划

> 最后更新：2026-02-06

## 目录

- [已完成功能](#已完成功能)
- [高优先级](#高优先级)
- [中优先级](#中优先级)
- [低优先级](#低优先级)
- [长期规划](#长期规划)

---

## 已完成功能

### 核心功能
- [x] 相册管理（创建、编辑、删除、分组）
- [x] 照片上传（支持批量、拖拽、分片上传）
- [x] 照片处理（缩略图生成、EXIF 提取、旋转）
- [x] 照片风格预设（日系、电影、黑白等）
- [x] 水印功能（文字、图片水印）
- [x] 相册分享（链接、二维码、海报）
- [x] 用户认证（JWT 登录、密码管理）
- [x] 多用户支持（管理员、普通用户）

### 相机直传 (FTP)
- [x] FTP 服务器（支持相机直连）
- [x] 被动模式支持（局域网/公网）
- [x] frp 内网穿透支持
- [x] 自动处理上传照片

### 部署相关
- [x] Docker Compose 一键部署
- [x] 单端口模式（Nginx 反向代理）
- [x] 环境变量模板 (.env.example)
- [x] 页面加载动画
- [x] 复制功能兼容性（HTTP 环境）
- [x] ICP 备案号配置支持

---

## 高优先级

### 1. 后台系统设置界面 ✅ 已完成
> 让用户通过网页配置系统，无需编辑 .env 文件

**功能点：**
- [x] 创建 `system_settings` 数据库表
- [x] 品牌设置
  - [x] 摄影师/工作室名称
  - [x] 品牌标语
  - [ ] Logo 上传（待实现）
  - [ ] Favicon 上传（待实现）
- [x] 版权与备案
  - [x] 版权声明文字
  - [x] ICP 备案号
  - [x] 公安备案号
- [x] 站点配置
  - [x] 站点标题
  - [x] 站点描述
  - [x] SEO 关键词
- [x] 功能开关
  - [x] 是否允许游客访问首页
  - [x] 默认是否启用水印
  - [x] 默认是否允许下载
  - [x] 是否显示 EXIF 信息
- [x] 社交链接
  - [ ] 微信二维码上传（待实现）
  - [x] 微博/Instagram 等链接
  - [x] 联系方式
- [x] 主题设置
  - [x] 主题模式（亮色/暗色/跟随系统）
  - [x] 主色调选择

**已完成的技术实现：**
```
1. 数据库表: system_settings
   - docker/init-postgresql-db.sql (新增表和初始数据)
   - docker/migrations/001_add_system_settings.sql (迁移脚本)

2. API 接口
   - GET /api/admin/settings - 获取所有设置
   - PATCH /api/admin/settings - 更新设置
   - GET /api/public/settings - 获取公开设置

3. 前端组件
   - components/admin/system-settings-section.tsx
   - hooks/use-settings.ts (useSettings, useAdminSettings, SettingsProvider)
   - lib/settings.ts (服务端获取设置)

4. Footer 组件更新
   - site-footer.tsx / album-footer.tsx 使用数据库设置
```

### 2. GitHub Releases 升级系统
> 基于版本号的自动升级，替代当前的 Git commit 对比

**功能点：**
- [ ] 版本检查
  - [ ] 调用 GitHub Releases API 获取最新版本
  - [ ] 对比当前版本与最新版本
  - [ ] 显示版本号（如 v1.2.0）
- [ ] 更新详情
  - [ ] 显示 Release Notes（更新日志）
  - [ ] 显示发布时间
  - [ ] 显示重要更新标记
- [ ] 一键升级
  - [ ] 自动备份当前配置
  - [ ] 拉取指定版本 Tag
  - [ ] 重新构建镜像（可选）
  - [ ] 重启服务
  - [ ] 显示升级进度
- [ ] 升级历史
  - [ ] 记录每次升级
  - [ ] 支持回滚到历史版本

**技术实现：**
```
1. API 接口
   GET /api/admin/upgrade/check
   - 调用 https://api.github.com/repos/JunyuZhan/pis/releases/latest
   - 返回: { currentVersion, latestVersion, hasUpdate, releaseNotes, publishedAt }

   POST /api/admin/upgrade/execute
   - 执行: git fetch --tags && git checkout v1.2.0
   - 可选: docker compose build --no-cache
   - 重启: docker compose up -d

2. 版本管理
   - 使用 package.json 中的 version 字段
   - 每次发布时创建 Git Tag 和 GitHub Release

3. 前端界面
   - 当前版本显示
   - 新版本提示徽章
   - 更新日志展示（Markdown 渲染）
   - 升级按钮和进度条
```

### 3. 海报预览图优化
> 为海报模板添加真实的预览效果

**功能点：**
- [ ] 海报模板预览图
  - [ ] 经典模板预览
  - [ ] 简约模板预览
  - [ ] 优雅模板预览
  - [ ] 商务模板预览
- [ ] 实时预览
  - [ ] 调整参数时实时更新预览
  - [ ] 使用相册封面作为背景
- [ ] 预设缩略图
  - [ ] 生成静态预览图
  - [ ] 存储到 public 目录

---

## 中优先级

### 4. 主题系统
> 支持多种主题风格

**功能点：**
- [ ] 内置主题
  - [ ] 亮色主题（默认）
  - [ ] 暗色主题
  - [ ] 自动跟随系统
- [ ] 自定义主题
  - [ ] 主色调选择
  - [ ] 背景色
  - [ ] 文字颜色
  - [ ] 圆角大小
- [ ] 主题切换
  - [ ] 前台主题切换按钮
  - [ ] 后台主题设置

### 5. 相册模板系统
> 预设相册样式模板

**功能点：**
- [ ] 内置模板
  - [ ] 婚礼相册模板
  - [ ] 活动相册模板
  - [ ] 人像相册模板
  - [ ] 产品相册模板
- [ ] 模板配置
  - [ ] 布局样式
  - [ ] 配色方案
  - [ ] 字体选择
- [ ] 自定义模板
  - [ ] 模板编辑器
  - [ ] 模板导入/导出

### 6. 客户管理
> 管理客户信息和相册关联

**功能点：**
- [ ] 客户信息
  - [ ] 姓名、电话、邮箱
  - [ ] 备注信息
  - [ ] 标签分类
- [ ] 相册关联
  - [ ] 一个客户多个相册
  - [ ] 快速筛选客户相册
- [ ] 通知功能
  - [ ] 相册就绪通知
  - [ ] 短信/邮件通知（可选）

### 7. 数据统计
> 相册访问和下载统计

**功能点：**
- [ ] 访问统计
  - [ ] 相册浏览量
  - [ ] 照片查看量
  - [ ] 访问来源
  - [ ] 访问设备
- [ ] 下载统计
  - [ ] 单张下载次数
  - [ ] 批量下载次数
  - [ ] 下载用户统计
- [ ] 数据可视化
  - [ ] 趋势图表
  - [ ] 热门相册排行
  - [ ] 导出报表

---

## 低优先级

### 8. 多语言支持增强
> 完善国际化支持

**功能点：**
- [ ] 后台语言切换
- [ ] 相册多语言标题/描述
- [ ] 语言包管理界面

### 9. 插件系统
> 支持第三方插件扩展

**功能点：**
- [ ] 插件 API
- [ ] 插件市场
- [ ] 官方插件（云存储、AI 修图等）

### 10. 移动端 App
> 原生移动应用

**功能点：**
- [ ] iOS App
- [ ] Android App
- [ ] 相册管理
- [ ] 推送通知

---

## 长期规划

### 11. AI 功能增强
- [ ] AI 自动修图
- [ ] AI 人脸识别分组
- [ ] AI 智能标签
- [ ] AI 相册描述生成

### 12. 协作功能
- [ ] 多摄影师协作
- [ ] 权限管理
- [ ] 操作日志

### 13. 云服务版本
- [ ] SaaS 多租户支持
- [ ] 订阅计费
- [ ] 云存储集成

---

## 版本规划

| 版本 | 主要功能 | 预计内容 |
|------|---------|---------|
| v1.1.0 | 后台配置 | 系统设置界面、品牌配置 |
| v1.2.0 | 升级系统 | GitHub Releases 升级、版本管理 |
| v1.3.0 | 主题系统 | 多主题支持、自定义主题 |
| v1.4.0 | 客户管理 | 客户信息、相册关联 |
| v1.5.0 | 数据统计 | 访问统计、数据可视化 |
| v2.0.0 | 重大更新 | AI 功能、插件系统 |

---

## 贡献指南

欢迎贡献代码！请参考以下步骤：

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'feat: add amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建 Pull Request

## 问题反馈

如有问题或建议，请通过以下方式反馈：

- [GitHub Issues](https://github.com/JunyuZhan/pis/issues)
- 邮箱：[项目维护者邮箱]

---

*此文档会随开发进度持续更新*
