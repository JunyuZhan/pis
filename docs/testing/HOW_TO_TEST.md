# ğŸ§ª å¦‚ä½•æµ‹è¯•é¡¹ç›®åŠŸèƒ½å®Œå…¨å¯ç”¨ï¼Œä¸šåŠ¡é€»è¾‘æ­£ç¡®

> **å¿«é€Ÿå‚è€ƒæŒ‡å—** - å¿«é€Ÿäº†è§£å¦‚ä½•éªŒè¯é¡¹ç›®åŠŸèƒ½

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

### æ­¥éª¤ 1: å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼A: ä½¿ç”¨ Dockerï¼ˆç”Ÿäº§/æµ‹è¯•ç¯å¢ƒï¼Œç«¯å£ 8081ï¼‰
cd docker && docker-compose up -d

# æ–¹å¼B: å¼€å‘æ¨¡å¼ï¼ˆå¼€å‘ç¯å¢ƒï¼Œç«¯å£ 3000ï¼‰
pnpm dev
```

**ç«¯å£è¯´æ˜**:
- Docker ç¯å¢ƒ: `http://localhost:8081`
- å¼€å‘ç¯å¢ƒ: `http://localhost:3000`
- E2E æµ‹è¯•: é»˜è®¤ä½¿ç”¨ `3000`ï¼ˆå¯é€šè¿‡ `BASE_URL` ç¯å¢ƒå˜é‡ä¿®æ”¹ï¼‰

### æ­¥éª¤ 2: å¿«é€ŸéªŒè¯æ ¸å¿ƒåŠŸèƒ½

```bash
# è¿è¡Œå¿«é€ŸéªŒè¯è„šæœ¬ï¼ˆæ–°åŠŸèƒ½ï¼‰
pnpm test:quick

# æˆ–ç›´æ¥è¿è¡Œ
bash scripts/test/quick-verify.sh
```

**é¢„æœŸè¾“å‡º**:
```
âœ… æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸ï¼
```

### æ­¥éª¤ 3: è¿è¡Œå®Œæ•´æµ‹è¯•

```bash
# æ–¹å¼1: ç»¼åˆæµ‹è¯•ï¼ˆæ¨èï¼‰
bash scripts/test/comprehensive-test.sh

# æ–¹å¼2: å®Œæ•´åŠŸèƒ½æµ‹è¯•
bash scripts/test/test-full-features.sh

# æ–¹å¼3: E2E æµ‹è¯•ï¼ˆå¯è§†åŒ–ï¼‰
pnpm test:e2e:ui
```

---

## ğŸ“‹ æµ‹è¯•å±‚æ¬¡

### 1ï¸âƒ£ å¿«é€ŸéªŒè¯ï¼ˆ~2åˆ†é’Ÿï¼‰

**ç”¨é€”**: éªŒè¯æ ¸å¿ƒæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ

```bash
pnpm test:quick
```

**æ£€æŸ¥é¡¹**:
- âœ… æœåŠ¡å¥åº·æ£€æŸ¥
- âœ… æ•°æ®åº“è¿æ¥
- âœ… API ç«¯ç‚¹å¯è®¿é—®
- âœ… å­˜å‚¨åŠŸèƒ½æ­£å¸¸
- âœ… ç”¨æˆ·åˆå§‹åŒ–åŠŸèƒ½ï¼ˆæ–°åŠŸèƒ½ï¼‰

---

### 2ï¸âƒ£ ä¸šåŠ¡é€»è¾‘æµ‹è¯•ï¼ˆ~5åˆ†é’Ÿï¼‰

**ç”¨é€”**: éªŒè¯æ ¸å¿ƒä¸šåŠ¡æµç¨‹æ˜¯å¦æ­£ç¡®

```bash
# ä¸šåŠ¡é€»è¾‘æµ‹è¯•
bash scripts/test/test-business-logic.sh

# API ç«¯ç‚¹æµ‹è¯•
bash scripts/test/test-api-endpoints.sh

# ç™»å½•æµç¨‹æµ‹è¯•
bash scripts/test/test-login-flow.sh
```

**æ£€æŸ¥é¡¹**:
- âœ… ç”¨æˆ·è®¤è¯æµç¨‹
- âœ… API å“åº”æ ¼å¼
- âœ… æ•°æ®ä¸€è‡´æ€§
- âœ… é”™è¯¯å¤„ç†

---

### 3ï¸âƒ£ åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•ï¼ˆ~10åˆ†é’Ÿï¼‰

**ç”¨é€”**: éªŒè¯æ‰€æœ‰åŠŸèƒ½æ˜¯å¦å®Œæ•´å¯ç”¨

```bash
# å®Œæ•´åŠŸèƒ½æµ‹è¯•
bash scripts/test/test-full-features.sh

# E2E æµ‹è¯•
pnpm test:e2e:ui
```

**æ£€æŸ¥é¡¹**:
- âœ… ç›¸å†Œåˆ›å»ºå’Œç®¡ç†
- âœ… ç…§ç‰‡ä¸Šä¼ å’Œå¤„ç†
- âœ… å›¾ç‰‡å¤„ç†ï¼ˆç¼©ç•¥å›¾ã€é¢„è§ˆå›¾ï¼‰
- âœ… ä¸‹è½½åŠŸèƒ½
- âœ… æ°´å°åŠŸèƒ½
- âœ… è®¿å®¢åŠŸèƒ½

---

### 4ï¸âƒ£ å…¨é¢æµ‹è¯•ï¼ˆ~30åˆ†é’Ÿï¼‰

**ç”¨é€”**: å®Œæ•´éªŒè¯é¡¹ç›®æ‰€æœ‰æ–¹é¢

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
bash scripts/test/test-all.sh

# æˆ–ç»¼åˆæµ‹è¯•
bash scripts/test/comprehensive-test.sh
```

**æ£€æŸ¥é¡¹**:
- âœ… æ‰€æœ‰ä¸Šè¿°æµ‹è¯•
- âœ… æ€§èƒ½æµ‹è¯•
- âœ… å®‰å…¨æµ‹è¯•
- âœ… è¾¹ç•Œæƒ…å†µæµ‹è¯•
- âœ… ç§»åŠ¨ç«¯æµ‹è¯•

---

## ğŸ¯ æ–°åŠŸèƒ½éªŒè¯ï¼ˆç”¨æˆ·åˆå§‹åŒ–ï¼‰

### éªŒè¯ç”¨æˆ·åˆå§‹åŒ–åŠŸèƒ½

```bash
# 1. è¿è¡Œç”¨æˆ·åˆå§‹åŒ–è„šæœ¬
pnpm init-users

# 2. éªŒè¯å„è§’è‰²è´¦æˆ·åˆ›å»º
docker exec pis-postgres psql -U pis -d pis -c \
  "SELECT email, role, is_active FROM users ORDER BY role;"

# é¢„æœŸè¾“å‡º:
# - admin@pis.com (admin)
# - photographer@pis.com (photographer)
# - retoucher@pis.com (retoucher)
# - guest@pis.com (guest)
```

### éªŒè¯éƒ¨ç½²è„šæœ¬é›†æˆ

```bash
# æ£€æŸ¥éƒ¨ç½²è„šæœ¬æ˜¯å¦åŒ…å«æ–°åŠŸèƒ½
grep -A 10 "init_users()" scripts/deploy/one-click-deploy.sh

# åº”è¯¥çœ‹åˆ° init_users å‡½æ•°å®šä¹‰
```

---

## âœ… æµ‹è¯•é€šè¿‡æ ‡å‡†

### æ ¸å¿ƒåŠŸèƒ½æ ‡å‡†

- âœ… **å¿«é€ŸéªŒè¯**: æ‰€æœ‰æ£€æŸ¥é¡¹é€šè¿‡
- âœ… **ä¸šåŠ¡é€»è¾‘**: æ‰€æœ‰ API ç«¯ç‚¹æ­£å¸¸å“åº”
- âœ… **åŠŸèƒ½å®Œæ•´æ€§**: æ ¸å¿ƒåŠŸèƒ½ï¼ˆä¸Šä¼ ã€ä¸‹è½½ã€å¤„ç†ï¼‰æ­£å¸¸
- âœ… **E2E æµ‹è¯•**: ç”¨æˆ·æµç¨‹æµ‹è¯•é€šè¿‡

### ä¸šåŠ¡é€»è¾‘æ­£ç¡®æ€§æ ‡å‡†

- âœ… **æ•°æ®ä¸€è‡´æ€§**: ç›¸å†Œç…§ç‰‡æ•°é‡ç»Ÿè®¡å‡†ç¡®
- âœ… **æƒé™æ§åˆ¶**: ç®¡ç†å‘˜å’Œè®¿å®¢æƒé™æ­£ç¡®
- âœ… **é”™è¯¯å¤„ç†**: å‹å¥½é”™è¯¯æç¤ºå’Œæ—¥å¿—è®°å½•
- âœ… **çŠ¶æ€ç®¡ç†**: ç…§ç‰‡çŠ¶æ€æµè½¬æ­£ç¡®ï¼ˆpending â†’ processing â†’ completedï¼‰

---

## ğŸ” å¸¸è§æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: éªŒè¯æ–°éƒ¨ç½²

```bash
# 1. å¿«é€ŸéªŒè¯
pnpm test:quick

# 2. å¦‚æœé€šè¿‡ï¼Œè¿è¡Œå®Œæ•´æµ‹è¯•
bash scripts/test/comprehensive-test.sh
```

### åœºæ™¯ 2: éªŒè¯æ–°åŠŸèƒ½

```bash
# 1. è¿è¡Œç›¸å…³åŠŸèƒ½æµ‹è¯•
bash scripts/test/test-full-features.sh

# 2. è¿è¡Œ E2E æµ‹è¯•éªŒè¯ç”¨æˆ·æµç¨‹
pnpm test:e2e:ui
```

### åœºæ™¯ 3: éªŒè¯ä¿®å¤

```bash
# 1. è¿è¡Œç‰¹å®šæµ‹è¯•è„šæœ¬
bash scripts/test/test-business-logic.sh

# 2. è¿è¡Œç›¸å…³ E2E æµ‹è¯•
pnpm exec playwright test e2e/admin-flow.spec.ts
```

---

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šä½ç½®

### å¿«é€ŸéªŒè¯æŠ¥å‘Š

è¾“å‡ºåœ¨ç»ˆç«¯ï¼ŒåŒ…å«é€šè¿‡/å¤±è´¥ç»Ÿè®¡

### ç»¼åˆæµ‹è¯•æŠ¥å‘Š

```bash
# æŸ¥çœ‹æŠ¥å‘Šæ–‡ä»¶
cat /tmp/pis-complete-test-report-*.txt
```

### E2E æµ‹è¯•æŠ¥å‘Š

```bash
# æ‰“å¼€ HTML æŠ¥å‘Š
pnpm exec playwright show-report

# æŠ¥å‘Šä½ç½®: playwright-report/index.html
```

---

## ğŸ› é—®é¢˜æ’æŸ¥

### é—®é¢˜: å¿«é€ŸéªŒè¯å¤±è´¥

**æ£€æŸ¥æ¸…å•**:
1. æœåŠ¡æ˜¯å¦å¯åŠ¨: `docker ps | grep pis-`
2. å¥åº·æ£€æŸ¥ï¼ˆDocker ç¯å¢ƒï¼‰: `curl http://localhost:8081/api/health`
3. å¥åº·æ£€æŸ¥ï¼ˆå¼€å‘ç¯å¢ƒï¼‰: `curl http://localhost:3000/api/health`
4. æ•°æ®åº“è¿æ¥: `docker exec pis-postgres psql -U pis -d pis -c "SELECT 1;"`

### é—®é¢˜: ç”¨æˆ·åˆå§‹åŒ–å¤±è´¥

**æ£€æŸ¥æ¸…å•**:
1. æ•°æ®åº“æ˜¯å¦è¿è¡Œ: `docker ps | grep postgres`
2. ç¯å¢ƒå˜é‡é…ç½®: `cat .env | grep DATABASE`
3. æ‰‹åŠ¨æµ‹è¯•: `pnpm init-users`

### é—®é¢˜: E2E æµ‹è¯•å¤±è´¥

**æ£€æŸ¥æ¸…å•**:
1. æœåŠ¡æ˜¯å¦è¿è¡Œ: `curl http://localhost:3000/api/health`
2. Playwright æµè§ˆå™¨: `pnpm exec playwright install --with-deps`
3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—: `pnpm test:e2e:debug`

---

## ğŸ“š æ›´å¤šä¿¡æ¯

- **è¯¦ç»†æµ‹è¯•æŒ‡å—**: [TESTING_GUIDE.md](./TESTING_GUIDE.md)
- **æµ‹è¯•æ–‡æ¡£**: [TESTING.md](./TESTING.md)
- **æµ‹è¯•è¦†ç›–ç‡**: [TEST_COVERAGE_ANALYSIS.md](./TEST_COVERAGE_ANALYSIS.md)

---

**æœ€åæ›´æ–°**: 2026-02-06
