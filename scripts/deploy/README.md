# éƒ¨ç½²è„šæœ¬

æœ¬ç›®å½•åŒ…å«æ‰€æœ‰éƒ¨ç½²ç›¸å…³çš„è„šæœ¬ã€‚

## ğŸ“‹ è„šæœ¬åˆ†ç±»

### ğŸš€ ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

| è„šæœ¬ | æè¿° | ä½¿ç”¨åœºæ™¯ | ç”¨æ³• |
|------|------|---------|------|
| `one-click-deploy.sh` | **çœŸæ­£çš„ä¸€é”®éƒ¨ç½²**ï¼ˆå®Œå…¨è‡ªåŠ¨åŒ–ï¼‰ | å¿«é€Ÿéƒ¨ç½²ï¼Œæ— éœ€äº¤äº’ | `curl -sSL <URL> \| bash` |
| `deploy.sh` | ä¸€é”®éƒ¨ç½²ï¼ˆæ”¯æŒæœ¬åœ°/è¿œç¨‹ï¼‰ | æœåŠ¡å™¨éƒ¨ç½²ï¼Œæ”¯æŒè¿œç¨‹ | `bash scripts/deploy/deploy.sh [IP]` |

### âš™ï¸ é…ç½®å’Œç®¡ç†è„šæœ¬

| è„šæœ¬ | æè¿° | ä½¿ç”¨åœºæ™¯ | ç”¨æ³• |
|------|------|---------|------|
| `setup.sh` | å¼•å¯¼å¼é…ç½®è„šæœ¬ï¼ˆäº¤äº’å¼èœå•ï¼‰ | æœ¬åœ°å¼€å‘ç¯å¢ƒè®¾ç½® | `bash scripts/deploy/setup.sh` |
| `quick-deploy.sh` | å¿«é€Ÿéƒ¨ç½²ï¼ˆç”Ÿæˆé…ç½®ï¼Œä¸ç®¡ç†å®¹å™¨ï¼‰ | åªç”Ÿæˆé…ç½®æ–‡ä»¶ | `bash scripts/deploy/quick-deploy.sh` |
| `quick-upgrade.sh` | å¿«é€Ÿå‡çº§ï¼ˆæ›´æ–°ä»£ç ï¼Œä¸ç®¡ç†å®¹å™¨ï¼‰ | åªæ›´æ–°ä»£ç å’Œé…ç½® | `bash scripts/deploy/quick-upgrade.sh` |

### ğŸ”§ æœåŠ¡ç®¡ç†è„šæœ¬

| è„šæœ¬ | æè¿° | ä½¿ç”¨åœºæ™¯ | ç”¨æ³• |
|------|------|---------|------|
| `start-internal-services.sh` | åªå¯åŠ¨å†…ç½‘æœåŠ¡ï¼ˆMinIOã€Redisã€æ•°æ®åº“ï¼‰ | å¼€å‘ç¯å¢ƒï¼Œåªéœ€è¦å­˜å‚¨æœåŠ¡ | `bash scripts/deploy/start-internal-services.sh` |
| `update-worker-on-server.sh` | æ›´æ–° Worker æœåŠ¡ | æ›´æ–° Worker é•œåƒ | `bash scripts/deploy/update-worker-on-server.sh` |
| `verify-deployment.sh` | éªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸ | éƒ¨ç½²åéªŒè¯ | `bash scripts/deploy/verify-deployment.sh` |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰

**å®Œå…¨è‡ªåŠ¨åŒ–éƒ¨ç½²**ï¼ˆæ— éœ€ä»»ä½•é…ç½®ï¼‰ï¼š

```bash
curl -sSL https://raw.githubusercontent.com/JunyuZhan/pis/main/scripts/deploy/one-click-deploy.sh | bash
```

**å¼•å¯¼å¼éƒ¨ç½²**ï¼ˆéœ€è¦äº¤äº’é…ç½®ï¼‰ï¼š

```bash
git clone https://github.com/JunyuZhan/pis.git
cd pis/docker
bash deploy.sh
```

### æ–¹æ³•äºŒï¼šæœ¬åœ°éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨

```bash
bash scripts/deploy/deploy.sh <æœåŠ¡å™¨IP> [ç”¨æˆ·å]
```

### æ–¹æ³•ä¸‰ï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å¼•å¯¼å¼è®¾ç½®ï¼ˆäº¤äº’å¼èœå•ï¼‰
bash scripts/deploy/setup.sh

# åªå¯åŠ¨å†…ç½‘æœåŠ¡ï¼ˆMinIOã€Redisã€æ•°æ®åº“ï¼‰
bash scripts/deploy/start-internal-services.sh
```

---

## ğŸ“– è„šæœ¬è¯¦ç»†è¯´æ˜

### 1. `one-click-deploy.sh` - çœŸæ­£çš„ä¸€é”®éƒ¨ç½² â­

**ç‰¹ç‚¹ï¼š**
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€äº¤äº’
- âœ… è‡ªåŠ¨å®‰è£… Docker å’Œ Docker Compose
- âœ… è‡ªåŠ¨å…‹éš†ä»£ç ï¼ˆå¦‚æœä¸åœ¨é¡¹ç›®ç›®å½•ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰å¯†é’¥å’Œå¯†ç 
- âœ… è‡ªåŠ¨å¯åŠ¨æ‰€æœ‰æœåŠ¡
- âœ… è‡ªåŠ¨åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿæµ‹è¯•éƒ¨ç½²
- æ¼”ç¤ºç¯å¢ƒéƒ¨ç½²
- ä¸éœ€è¦è‡ªå®šä¹‰é…ç½®çš„åœºæ™¯

**ç”¨æ³•ï¼š**
```bash
# ä» GitHub ç›´æ¥è¿è¡Œ
curl -sSL https://raw.githubusercontent.com/JunyuZhan/pis/main/scripts/deploy/one-click-deploy.sh | bash

# æˆ–åœ¨é¡¹ç›®ç›®å½•ä¸­è¿è¡Œ
bash scripts/deploy/one-click-deploy.sh
```

---

### 2. `deploy.sh` - ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆåŠŸèƒ½å®Œæ•´ï¼‰

**ç‰¹ç‚¹ï¼š**
- âœ… æ”¯æŒæœ¬åœ°å’Œè¿œç¨‹éƒ¨ç½²
- âœ… è‡ªåŠ¨å®‰è£… Docker å’Œ Docker Compose
- âœ… æ”¯æŒéäº¤äº’å¼æ¨¡å¼ï¼ˆç¯å¢ƒå˜é‡ï¼‰
- âœ… å¤šç§æ„å»ºç­–ç•¥

**ä½¿ç”¨åœºæ™¯ï¼š**
- æœåŠ¡å™¨ä¸Šå¿«é€Ÿéƒ¨ç½²
- CI/CD è‡ªåŠ¨åŒ–éƒ¨ç½²
- è¿œç¨‹æœåŠ¡å™¨éƒ¨ç½²

**ç”¨æ³•ï¼š**
```bash
# åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥è¿è¡Œ
curl -sSL https://raw.githubusercontent.com/JunyuZhan/pis/main/scripts/deploy/deploy.sh | bash

# åœ¨æœ¬åœ°è¿è¡Œï¼Œè¿œç¨‹éƒ¨ç½²
bash scripts/deploy/deploy.sh <æœåŠ¡å™¨IP> [ç”¨æˆ·å]
```

---

### 4. `setup.sh` - å¼•å¯¼å¼é…ç½®è„šæœ¬

**ç‰¹ç‚¹ï¼š**
- âœ… äº¤äº’å¼èœå•
- âœ… æœ¬åœ°å¼€å‘ç¯å¢ƒè®¾ç½®
- âœ… ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²é…ç½®
- âœ… Docker æœåŠ¡ç®¡ç†

**ä½¿ç”¨åœºæ™¯ï¼š**
- æœ¬åœ°å¼€å‘ç¯å¢ƒè®¾ç½®
- éœ€è¦äº¤äº’å¼é…ç½®
- ç®¡ç† Docker æœåŠ¡

**ç”¨æ³•ï¼š**
```bash
bash scripts/deploy/setup.sh
```

---

### 5. `quick-deploy.sh` - å¿«é€Ÿéƒ¨ç½²ï¼ˆåªç”Ÿæˆé…ç½®ï¼‰

**ç‰¹ç‚¹ï¼š**
- âœ… å¿«é€Ÿç”Ÿæˆé…ç½®æ–‡ä»¶
- âœ… ä¸ç®¡ç†æœåŠ¡å™¨ä¸Šçš„å®¹å™¨
- âœ… æ”¯æŒè‡ªå®šä¹‰ MinIO å¯†é’¥

**ä½¿ç”¨åœºæ™¯ï¼š**
- åªç”Ÿæˆé…ç½®æ–‡ä»¶
- ä¸å¯åŠ¨å®¹å™¨
- é…ç½®åæ‰‹åŠ¨å¯åŠ¨å®¹å™¨

**ç”¨æ³•ï¼š**
```bash
bash scripts/deploy/quick-deploy.sh
bash scripts/deploy/quick-deploy.sh --minio-user albert --minio-pass Zjy-1314
```

---

### 6. `quick-upgrade.sh` - å¿«é€Ÿå‡çº§ï¼ˆåªæ›´æ–°ä»£ç ï¼‰

**ç‰¹ç‚¹ï¼š**
- âœ… æ‹‰å–æœ€æ–°ä»£ç 
- âœ… æ›´æ–°é…ç½®æ–‡ä»¶
- âœ… ä¸ç®¡ç†æœåŠ¡å™¨ä¸Šçš„å®¹å™¨

**ä½¿ç”¨åœºæ™¯ï¼š**
- å‡çº§ä»£ç å’Œé…ç½®
- ä¸é‡å¯å®¹å™¨
- é…ç½®åæ‰‹åŠ¨é‡å¯å®¹å™¨

**ç”¨æ³•ï¼š**
```bash
bash scripts/deploy/quick-upgrade.sh
bash scripts/deploy/quick-upgrade.sh --force
```

---

### 7. `start-internal-services.sh` - å¯åŠ¨å†…ç½‘æœåŠ¡

**ç‰¹ç‚¹ï¼š**
- âœ… åªå¯åŠ¨åŸºç¡€æœåŠ¡ï¼ˆMinIOã€Redisã€æ•°æ®åº“ï¼‰
- âœ… ä¸å¯åŠ¨ Worker å’Œ Web æœåŠ¡
- âœ… è‡ªåŠ¨æ£€æµ‹ docker-compose é…ç½®

**ä½¿ç”¨åœºæ™¯ï¼š**
- æœ¬åœ°å¼€å‘æ—¶åªéœ€è¦å­˜å‚¨å’Œæ•°æ®åº“æœåŠ¡
- æµ‹è¯•ç¯å¢ƒåªéœ€è¦åŸºç¡€æœåŠ¡

**ç”¨æ³•ï¼š**
```bash
bash scripts/deploy/start-internal-services.sh
```

---

### 8. `update-worker-on-server.sh` - æ›´æ–° Worker æœåŠ¡

**ç‰¹ç‚¹ï¼š**
- âœ… æ‹‰å–æœ€æ–°ä»£ç ï¼ˆå¯é€‰ï¼‰
- âœ… æ›´æ–°ç¯å¢ƒé…ç½®
- âœ… é‡æ–°æ„å»º Worker é•œåƒ
- âœ… é‡å¯ Worker æœåŠ¡

**ä½¿ç”¨åœºæ™¯ï¼š**
- æ›´æ–° Worker æœåŠ¡
- åº”ç”¨ä»£ç æ›´æ–°

**ç”¨æ³•ï¼š**
```bash
bash scripts/deploy/update-worker-on-server.sh
```

---

### 9. `verify-deployment.sh` - éªŒè¯éƒ¨ç½²

**ç‰¹ç‚¹ï¼š**
- âœ… ç«¯åˆ°ç«¯éªŒè¯éƒ¨ç½²æ˜¯å¦æˆåŠŸ
- âœ… æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
- âœ… æµ‹è¯• API ç«¯ç‚¹

**ä½¿ç”¨åœºæ™¯ï¼š**
- éƒ¨ç½²åéªŒè¯
- æ•…éšœæ’æŸ¥

**ç”¨æ³•ï¼š**
```bash
bash scripts/deploy/verify-deployment.sh [SSH_HOST]
```

---

## ğŸ¯ é€‰æ‹©æŒ‡å—

### æˆ‘éœ€è¦ä»€ä¹ˆè„šæœ¬ï¼Ÿ

| åœºæ™¯ | æ¨èè„šæœ¬ | è¯´æ˜ |
|------|---------|------|
| **é¦–æ¬¡éƒ¨ç½²ï¼Œå®Œå…¨è‡ªåŠ¨åŒ–** | `one-click-deploy.sh` | æ— éœ€ä»»ä½•é…ç½®ï¼Œä¸€é”®å®Œæˆ |
| **é¦–æ¬¡éƒ¨ç½²ï¼Œéœ€è¦é…ç½®** | `docker/deploy.sh` | å¼•å¯¼å¼é…ç½®ï¼Œé€‚åˆæ–°æ‰‹ |
| **æœåŠ¡å™¨å¿«é€Ÿéƒ¨ç½²** | `deploy.sh` | åŠŸèƒ½å®Œæ•´ï¼Œæ”¯æŒè¿œç¨‹ |
| **æœ¬åœ°å¼€å‘ç¯å¢ƒ** | `setup.sh` | äº¤äº’å¼èœå•ï¼Œçµæ´»é…ç½® |
| **åªç”Ÿæˆé…ç½®** | `quick-deploy.sh` | ä¸ç®¡ç†å®¹å™¨ï¼Œåªç”Ÿæˆé…ç½® |
| **åªæ›´æ–°ä»£ç ** | `quick-upgrade.sh` | ä¸ç®¡ç†å®¹å™¨ï¼Œåªæ›´æ–°ä»£ç  |
| **åªå¯åŠ¨å­˜å‚¨æœåŠ¡** | `start-internal-services.sh` | è½»é‡çº§ï¼Œé€‚åˆå¼€å‘ |
| **æ›´æ–° Worker** | `update-worker-on-server.sh` | æ›´æ–° Worker æœåŠ¡ |
| **éªŒè¯éƒ¨ç½²** | `verify-deployment.sh` | æ£€æŸ¥éƒ¨ç½²æ˜¯å¦æˆåŠŸ |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [éƒ¨ç½²è„šæœ¬è¯¦ç»†è¯´æ˜](./DEPLOYMENT_SCRIPTS.md) - è¯¦ç»†çš„è„šæœ¬åŠŸèƒ½è¯´æ˜
- [å¿«é€Ÿéƒ¨ç½²æŒ‡å—](./QUICK_GUIDE.md) - å¿«é€Ÿéƒ¨ç½²æ­¥éª¤
- [éƒ¨ç½²æŒ‡å—](../docs/i18n/zh-CN/DEPLOYMENT.md) - å®Œæ•´éƒ¨ç½²æ–‡æ¡£
- [éƒ¨ç½²æŒ‡å— (English)](../docs/i18n/en/DEPLOYMENT.md) - Deployment guide

---

## ğŸ”§ Docker Compose é…ç½®æ–‡ä»¶

é¡¹ç›®æä¾›äº†å¤šä¸ª docker-compose é…ç½®æ–‡ä»¶ï¼š

| æ–‡ä»¶ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|------|------|---------|
| `docker/docker-compose.yml` | ç”Ÿäº§ç¯å¢ƒï¼ˆæ¨èï¼‰ | PostgreSQL + MinIO + Redis + Web + Workerï¼ˆå•ç«¯å£æ¨¡å¼ï¼‰ |
| `docker/docker-compose.dev.yml` | å¼€å‘ç¯å¢ƒ | PostgreSQL + MinIO + Redisï¼ˆWeb å’Œ Worker æœ¬åœ°è¿è¡Œï¼‰ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**ï¼šæ‰€æœ‰è„šæœ¬éƒ½ä½¿ç”¨æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶è¿›è¡Œé…ç½®
2. **Docker æƒé™**ï¼šç¡®ä¿å½“å‰ç”¨æˆ·æœ‰ Docker æ‰§è¡Œæƒé™
3. **ç«¯å£å†²çª**ï¼šç¡®ä¿æ‰€éœ€ç«¯å£æœªè¢«å ç”¨
4. **ç½‘ç»œè®¿é—®**ï¼šç¡®ä¿å¯ä»¥è®¿é—® Docker Hubï¼ˆæ‹‰å–é•œåƒï¼‰

---

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹è„šæœ¬æ—¥å¿—è¾“å‡º
2. æ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€ï¼š`docker ps`
3. æŸ¥çœ‹æœåŠ¡æ—¥å¿—ï¼š`docker-compose logs -f`
4. å‚è€ƒ [éƒ¨ç½²æ–‡æ¡£](../docs/i18n/zh-CN/DEPLOYMENT.md)
